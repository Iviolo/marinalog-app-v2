<!DOCTYPE html><html lang="it"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>MarinaLog - Gestione Personale</title><style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:'Segoe UI',Tahoma,sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);min-height:100vh;padding:20px}.header{background:#fff;padding:20px;border-radius:15px;box-shadow:0 10px 30px rgba(0,0,0,0.2);margin-bottom:20px;text-align:center}.header h1{color:#667eea;font-size:28px}.container{max-width:900px;margin:0 auto}.tabs{display:flex;gap:10px;margin-bottom:20px;flex-wrap:wrap;overflow-x:auto}.tab-btn{padding:12px 25px;background:#fff;border:2px solid #ddd;border-radius:8px;cursor:pointer;font-weight:bold;color:#667eea;transition:all 0.3s;white-space:nowrap}.tab-btn.active{background:#667eea;color:#fff;border-color:#667eea}.tab-content{background:#fff;padding:30px;border-radius:15px;box-shadow:0 10px 30px rgba(0,0,0,0.2);display:none}.tab-content.active{display:block}.stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:20px;margin-bottom:30px}.stat-card{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;padding:20px;border-radius:10px;text-align:center}.stat-card.pink{background:linear-gradient(135deg,#f093fb,#f5576c)}.stat-card.cyan{background:linear-gradient(135deg,#4facfe,#00f2fe)}.stat-card.green{background:linear-gradient(135deg,#43e97b,#38f9d7)}.stat-value{font-size:32px;font-weight:bold;margin:10px 0}.form-group{margin:20px 0}.form-group label{display:block;font-weight:bold;margin-bottom:8px}.form-group input,.form-group select,.form-group textarea{width:100%;padding:12px;border:2px solid #ddd;border-radius:8px;font-size:14px}.btn-submit{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;padding:14px;border:none;border-radius:8px;font-weight:bold;cursor:pointer;width:100%;font-size:16px}.entry-item{background:#f9f9f9;padding:15px;border-radius:8px;margin-bottom:10px;border-left:5px solid #667eea;display:flex;justify-content:space-between;align-items:center}.btn-delete{background:#f5576c;color:#fff;border:none;padding:8px 15px;border-radius:6px;cursor:pointer;font-weight:bold}.no-data{text-align:center;color:#999;padding:40px}.chat-box{background:#f5f5f5;border:1px solid #ddd;border-radius:8px;padding:15px;height:400px;overflow-y:auto;margin-bottom:15px}.chat-message{margin:10px 0;padding:10px;border-radius:6px;background:#e3f2fd;color:#333;word-wrap:break-word}.chat-message.user{background:#667eea;color:#fff;text-align:right;margin-left:20%}.chat-message.bot{background:#f0f0f0;color:#333;margin-right:20%}.chat-input-group{display:flex;gap:10px}.chat-input-group input{flex:1;padding:10px;border:2px solid #ddd;border-radius:8px}.chat-input-group button{padding:10px 20px;background:#667eea;color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:bold}.loading{color:#999;font-style:italic}</style></head><body><div class="header"><h1>‚öì MARINALOG</h1><p>Gestione Personale - Ferie, Reperibilit√† e Guardie</p></div><div class="container"><div class="tabs"><button class="tab-btn active" data-tab="dashboard">Dashboard</button><button class="tab-btn" data-tab="add">Aggiungi</button><button class="tab-btn" data-tab="history">Cronologia</button><button class="tab-btn" data-tab="assistant">ü§ñ Assistente IA</button></div><div id="dashboard" class="tab-content active"><h2>Statistiche</h2><div class="stats-grid"><div class="stat-card"><div>Ferie Ordinarie</div><div class="stat-value" id="ferie-val">0/39</div></div><div class="stat-card pink"><div>Malattia</div><div class="stat-value" id="malattia-val">0/4</div></div><div class="stat-card cyan"><div>Reperibilit√† (h)</div><div class="stat-value" id="reperibilita-val">0</div></div><div class="stat-card green"><div>Compensi</div><div class="stat-value" id="compensi-val">‚Ç¨0</div></div></div><h3>Ultime Registrazioni</h3><div id="latest-entries"></div></div><div id="add" class="tab-content"><h2>Aggiungi Registrazione</h2><form onsubmit="addEntry(event)"><div class="form-group"><label>Data:</label><input type="date" id="entry-date" required></div><div class="form-group"><label>Tipo:</label><select id="entry-type" required><option>Ferie Ordinarie</option><option>Malattia</option><option>Reperibilit√†</option><option>Guardia</option></select></div><div class="form-group"><label>Ore:</label><input type="number" id="entry-hours" placeholder="es. 8" min="0" step="0.5"></div><div class="form-group"><label>Note:</label><textarea id="entry-notes" placeholder="Aggiungi note..."></textarea></div><button type="submit" class="btn-submit">‚úì Registra</button></form></div><div id="history" class="tab-content"><h2>Cronologia</h2><div id="history-entries"></div></div><div id="assistant" class="tab-content"><h2>ü§ñ Assistente IA (Gemini)</h2><div class="chat-box" id="chat-box"></div><div class="chat-input-group"><input type="text" id="chat-input" placeholder="Chiedi qualsiasi cosa all'IA..."><button onclick="sendAIMessage()" type="button">Invia</button></div></div></div><script>const GEMINI_API_KEY='AIzaSyBNCf0dmzdrk3UjQzif6JWaV7jAhle-GM';let entries=JSON.parse(localStorage.getItem('marinalog_entries'))||[];document.querySelectorAll('.tab-btn').forEach(btn=>{btn.addEventListener('click',function(){showTab(this.getAttribute('data-tab'))})});function showTab(tab){document.querySelectorAll('.tab-content').forEach(el=>el.classList.remove('active'));document.querySelectorAll('.tab-btn').forEach(el=>el.classList.remove('active'));document.getElementById(tab).classList.add('active');document.querySelector('[data-tab="'+tab+'"]').classList.add('active')}function addEntry(e){e.preventDefault();const entry={date:document.getElementById('entry-date').value,type:document.getElementById('entry-type').value,hours:parseFloat(document.getElementById('entry-hours').value)||0,notes:document.getElementById('entry-notes').value};entries.push(entry);localStorage.setItem('marinalog_entries',JSON.stringify(entries));updateStats();document.getElementById('entry-hours').value='';document.getElementById('entry-notes').value='';alert('‚úì Registrazione aggiunta!')}function updateStats(){let ferie=entries.filter(e=>e.type==='Ferie Ordinarie').length;let malattia=entries.filter(e=>e.type==='Malattia').length;let reperibilita=entries.filter(e=>e.type==='Reperibilit√†').reduce((sum,e)=>sum+e.hours,0);let guardia=entries.filter(e=>e.type==='Guardia').reduce((sum,e)=>sum+e.hours,0);let compensi=(reperibilita*30)+(guardia*90);document.getElementById('ferie-val').textContent=ferie+'/39';document.getElementById('malattia-val').textContent=malattia+'/4';document.getElementById('reperibilita-val').textContent=reperibilita.toFixed(1);document.getElementById('compensi-val').textContent='‚Ç¨'+compensi.toFixed(2);renderLatest()}function renderLatest(){let html='';entries.slice(-5).reverse().forEach((e,idx)=>{html+=`<div class="entry-item"><div><strong>${e.date}</strong> - ${e.type}${e.hours?' ('+e.hours+'h)':''}</div><button type="button" class="btn-delete" onclick="deleteEntry(${entries.length-1-idx})">‚ùå</button></div>`});document.getElementById('latest-entries').innerHTML=html||'<div class="no-data">Nessuna registrazione</div>'}function renderHistory(){let html='';entries.forEach((e,idx)=>{html+=`<div class="entry-item"><div><strong>${e.date}</strong> - ${e.type}${e.hours?' ('+e.hours+'h)':''}</div><button type="button" class="btn-delete" onclick="deleteEntry(${idx})">‚ùå</button></div>`});document.getElementById('history-entries').innerHTML=html||'<div class="no-data">Nessuna registrazione</div>'}function deleteEntry(idx){if(confirm('Elimina?')){entries.splice(idx,1);localStorage.setItem('marinalog_entries',JSON.stringify(entries));updateStats();renderHistory()}}async function sendAIMessage(){const input=document.getElementById('chat-input');const msg=input.value.trim();if(!msg)return;const chatBox=document.getElementById('chat-box');const userMsg=document.createElement('div');userMsg.className='chat-message user';userMsg.textContent=msg;chatBox.appendChild(userMsg);input.value='';const botMsg=document.createElement('div');botMsg.className='chat-message bot loading';botMsg.textContent='Gemini sta rispondendo...';chatBox.appendChild(botMsg);try{const response=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${GEMINI_API_KEY}`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({contents:[{parts:[{text:'Contesto: Sono un assistente per un app di gestione leave/ferie. Dati utente: Ferie: '+entries.filter(e=>e.type==='Ferie Ordinarie').length+'/39, Malattia: '+entries.filter(e=>e.type==='Malattia').length+'/4, Reperibilit√†: '+entries.filter(e=>e.type==='Reperibilit√†').reduce((s,e)=>s+e.hours,0)+'h, Guardia: '+entries.filter(e=>e.type==='Guardia').reduce((s,e)=>s+e.hours,0)+'h. Domanda utente: '+msg}]},]}});const data=await response.json();const text=data.candidates?.[0]?.content?.parts?.[0]?.text||'Scusa, non riesco a elaborare questa richiesta.';botMsg.textContent=text;botMsg.classList.remove('loading')}catch(e){botMsg.textContent='Errore: '+e.message;botMsg.classList.remove('loading')}chatBox.scrollTop=chatBox.scrollHeight}function init(){const today=new Date().toISOString().split('T')[0];document.getElementById('entry-date').value=today;updateStats();renderHistory();document.getElementById('chat-input').addEventListener('keypress',e=>{if(e.key==='Enter')sendAIMessage()})}init()</script></body></html>
